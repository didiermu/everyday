import{L as H,F as O,C as T,S as Y,G as k,B as F,a as V,b as C,M as S,P as _,c as N,d as U,e as I,f as A,V as z,g as W,h as q,W as X,A as J,D as K,i as Q,j as Z,k as $,l as ee,m as te}from"./three-yH4q0MRI.js";import{s as se}from"./loadLocomotive-DUo0yfuB.js";const ne=/^[og]\s*(.+)?/,ie=/^mtllib /,oe=/^usemtl /,re=/^usemap /,R=/\s+/,B=new z,E=new z,G=new z,D=new z,j=new z,P=new T;function ae(){const x={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(t,e){if(this.object&&this.object.fromDeclaration===!1){this.object.name=t,this.object.fromDeclaration=e!==!1;return}const n=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:t||"",fromDeclaration:e!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(s,i){const a=this._finalize(!1);a&&(a.inherited||a.groupCount<=0)&&this.materials.splice(a.index,1);const r={index:this.materials.length,name:s||"",mtllib:Array.isArray(i)&&i.length>0?i[i.length-1]:"",smooth:a!==void 0?a.smooth:this.smooth,groupStart:a!==void 0?a.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(y){const l={index:typeof y=="number"?y:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return l.clone=this.clone.bind(l),l}};return this.materials.push(r),r},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(s){const i=this.currentMaterial();if(i&&i.groupEnd===-1&&(i.groupEnd=this.geometry.vertices.length/3,i.groupCount=i.groupEnd-i.groupStart,i.inherited=!1),s&&this.materials.length>1)for(let a=this.materials.length-1;a>=0;a--)this.materials[a].groupCount<=0&&this.materials.splice(a,1);return s&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),i}},n&&n.name&&typeof n.clone=="function"){const s=n.clone(0);s.inherited=!0,this.object.materials.push(s)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(t,e){const n=parseInt(t,10);return(n>=0?n-1:n+e/3)*3},parseNormalIndex:function(t,e){const n=parseInt(t,10);return(n>=0?n-1:n+e/3)*3},parseUVIndex:function(t,e){const n=parseInt(t,10);return(n>=0?n-1:n+e/2)*2},addVertex:function(t,e,n){const s=this.vertices,i=this.object.geometry.vertices;i.push(s[t+0],s[t+1],s[t+2]),i.push(s[e+0],s[e+1],s[e+2]),i.push(s[n+0],s[n+1],s[n+2])},addVertexPoint:function(t){const e=this.vertices;this.object.geometry.vertices.push(e[t+0],e[t+1],e[t+2])},addVertexLine:function(t){const e=this.vertices;this.object.geometry.vertices.push(e[t+0],e[t+1],e[t+2])},addNormal:function(t,e,n){const s=this.normals,i=this.object.geometry.normals;i.push(s[t+0],s[t+1],s[t+2]),i.push(s[e+0],s[e+1],s[e+2]),i.push(s[n+0],s[n+1],s[n+2])},addFaceNormal:function(t,e,n){const s=this.vertices,i=this.object.geometry.normals;B.fromArray(s,t),E.fromArray(s,e),G.fromArray(s,n),j.subVectors(G,E),D.subVectors(B,E),j.cross(D),j.normalize(),i.push(j.x,j.y,j.z),i.push(j.x,j.y,j.z),i.push(j.x,j.y,j.z)},addColor:function(t,e,n){const s=this.colors,i=this.object.geometry.colors;s[t]!==void 0&&i.push(s[t+0],s[t+1],s[t+2]),s[e]!==void 0&&i.push(s[e+0],s[e+1],s[e+2]),s[n]!==void 0&&i.push(s[n+0],s[n+1],s[n+2])},addUV:function(t,e,n){const s=this.uvs,i=this.object.geometry.uvs;i.push(s[t+0],s[t+1]),i.push(s[e+0],s[e+1]),i.push(s[n+0],s[n+1])},addDefaultUV:function(){const t=this.object.geometry.uvs;t.push(0,0),t.push(0,0),t.push(0,0)},addUVLine:function(t){const e=this.uvs;this.object.geometry.uvs.push(e[t+0],e[t+1])},addFace:function(t,e,n,s,i,a,r,y,l){const h=this.vertices.length;let o=this.parseVertexIndex(t,h),c=this.parseVertexIndex(e,h),m=this.parseVertexIndex(n,h);if(this.addVertex(o,c,m),this.addColor(o,c,m),r!==void 0&&r!==""){const f=this.normals.length;o=this.parseNormalIndex(r,f),c=this.parseNormalIndex(y,f),m=this.parseNormalIndex(l,f),this.addNormal(o,c,m)}else this.addFaceNormal(o,c,m);if(s!==void 0&&s!==""){const f=this.uvs.length;o=this.parseUVIndex(s,f),c=this.parseUVIndex(i,f),m=this.parseUVIndex(a,f),this.addUV(o,c,m),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(t){this.object.geometry.type="Points";const e=this.vertices.length;for(let n=0,s=t.length;n<s;n++){const i=this.parseVertexIndex(t[n],e);this.addVertexPoint(i),this.addColor(i)}},addLineGeometry:function(t,e){this.object.geometry.type="Line";const n=this.vertices.length,s=this.uvs.length;for(let i=0,a=t.length;i<a;i++)this.addVertexLine(this.parseVertexIndex(t[i],n));for(let i=0,a=e.length;i<a;i++)this.addUVLine(this.parseUVIndex(e[i],s))}};return x.startObject("",!1),x}class le extends H{constructor(t){super(t),this.materials=null}load(t,e,n,s){const i=this,a=new O(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(t,function(r){try{e(i.parse(r))}catch(y){s?s(y):console.error(y),i.manager.itemError(t)}},n,s)}setMaterials(t){return this.materials=t,this}parse(t){const e=new ae;t.indexOf(`\r
`)!==-1&&(t=t.replace(/\r\n/g,`
`)),t.indexOf(`\\
`)!==-1&&(t=t.replace(/\\\n/g,""));const n=t.split(`
`);let s=[];for(let r=0,y=n.length;r<y;r++){const l=n[r].trimStart();if(l.length===0)continue;const h=l.charAt(0);if(h!=="#")if(h==="v"){const o=l.split(R);switch(o[0]){case"v":e.vertices.push(parseFloat(o[1]),parseFloat(o[2]),parseFloat(o[3])),o.length>=7?(P.setRGB(parseFloat(o[4]),parseFloat(o[5]),parseFloat(o[6]),Y),e.colors.push(P.r,P.g,P.b)):e.colors.push(void 0,void 0,void 0);break;case"vn":e.normals.push(parseFloat(o[1]),parseFloat(o[2]),parseFloat(o[3]));break;case"vt":e.uvs.push(parseFloat(o[1]),parseFloat(o[2]));break}}else if(h==="f"){const c=l.slice(1).trim().split(R),m=[];for(let u=0,b=c.length;u<b;u++){const w=c[u];if(w.length>0){const d=w.split("/");m.push(d)}}const f=m[0];for(let u=1,b=m.length-1;u<b;u++){const w=m[u],d=m[u+1];e.addFace(f[0],w[0],d[0],f[1],w[1],d[1],f[2],w[2],d[2])}}else if(h==="l"){const o=l.substring(1).trim().split(" ");let c=[];const m=[];if(l.indexOf("/")===-1)c=o;else for(let f=0,u=o.length;f<u;f++){const b=o[f].split("/");b[0]!==""&&c.push(b[0]),b[1]!==""&&m.push(b[1])}e.addLineGeometry(c,m)}else if(h==="p"){const c=l.slice(1).trim().split(" ");e.addPointGeometry(c)}else if((s=ne.exec(l))!==null){const o=(" "+s[0].slice(1).trim()).slice(1);e.startObject(o)}else if(oe.test(l))e.object.startMaterial(l.substring(7).trim(),e.materialLibraries);else if(ie.test(l))e.materialLibraries.push(l.substring(7).trim());else if(re.test(l))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(h==="s"){if(s=l.split(" "),s.length>1){const c=s[1].trim().toLowerCase();e.object.smooth=c!=="0"&&c!=="off"}else e.object.smooth=!0;const o=e.object.currentMaterial();o&&(o.smooth=e.object.smooth)}else{if(l==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+l+'"')}}e.finalize();const i=new k;if(i.materialLibraries=[].concat(e.materialLibraries),!(e.objects.length===1&&e.objects[0].geometry.vertices.length===0)===!0)for(let r=0,y=e.objects.length;r<y;r++){const l=e.objects[r],h=l.geometry,o=l.materials,c=h.type==="Line",m=h.type==="Points";let f=!1;if(h.vertices.length===0)continue;const u=new F;u.setAttribute("position",new V(h.vertices,3)),h.normals.length>0&&u.setAttribute("normal",new V(h.normals,3)),h.colors.length>0&&(f=!0,u.setAttribute("color",new V(h.colors,3))),h.hasUVIndices===!0&&u.setAttribute("uv",new V(h.uvs,2));const b=[];for(let d=0,v=o.length;d<v;d++){const p=o[d],L=p.name+"_"+p.smooth+"_"+f;let g=e.materials[L];if(this.materials!==null){if(g=this.materials.create(p.name),c&&g&&!(g instanceof C)){const M=new C;S.prototype.copy.call(M,g),M.color.copy(g.color),g=M}else if(m&&g&&!(g instanceof _)){const M=new _({size:10,sizeAttenuation:!1});S.prototype.copy.call(M,g),M.color.copy(g.color),M.map=g.map,g=M}}g===void 0&&(c?g=new C:m?g=new _({size:1,sizeAttenuation:!1}):g=new N,g.name=p.name,g.flatShading=!p.smooth,g.vertexColors=f,e.materials[L]=g),b.push(g)}let w;if(b.length>1){for(let d=0,v=o.length;d<v;d++){const p=o[d];u.addGroup(p.groupStart,p.groupCount,d)}c?w=new U(u,b):m?w=new I(u,b):w=new A(u,b)}else c?w=new U(u,b[0]):m?w=new I(u,b[0]):w=new A(u,b[0]);w.name=l.name,i.add(w)}else if(e.vertices.length>0){const r=new _({size:1,sizeAttenuation:!1}),y=new F;y.setAttribute("position",new V(e.vertices,3)),e.colors.length>0&&e.colors[0]!==void 0&&(y.setAttribute("color",new V(e.colors,3)),r.vertexColors=!0);const l=new I(y,r);i.add(l)}return i}}const ce=()=>{const x=document.getElementById("modal-video"),t=x.querySelector("video");document.querySelector(".btn-play").addEventListener("click",()=>{x.showModal(),t.play()}),document.querySelector("#modal-video .close").addEventListener("click",()=>{t.pause(),t.currentTime=0,x.close()}),x.addEventListener("close",()=>{t.pause(),t.currentTime=0})},de=x=>{const t=new W;t.background=null;const e=new q(60,window.innerWidth/window.innerHeight,.1,100);e.position.set(0,0,6),e.lookAt(0,0,0);const n=new X({antialias:!0,alpha:!0});n.setSize(window.innerWidth,window.innerHeight),n.setPixelRatio(Math.min(window.devicePixelRatio,2)),n.domElement.style.position="fixed",n.domElement.style.top="-130px",n.domElement.style.left="30px",n.domElement.style.pointerEvents="none",document.querySelector("main").insertAdjacentElement("afterbegin",n.domElement),t.add(new J(16777215,2));const s=new K(16777215,1.6);s.position.set(2,.3,5),t.add(s);function i(){const v=document.createElement("canvas");v.width=256,v.height=256;const p=v.getContext("2d"),L=p.createRadialGradient(256/2,256/2,256*.15,256/2,256/2,256*.5);return L.addColorStop(0,"rgba(0,0,0,0.1)"),L.addColorStop(1,"rgba(0,0,0,0)"),p.fillStyle=L,p.fillRect(0,0,256,256),new ee(v)}const a=new A(new Q(1,.5),new Z({map:i(),transparent:!0,depthWrite:!1}));a.rotation.x=1,a.rotation.y=-1,a.rotation.z=-1,a.position.set(.3,.4,.1);let r;new le().load("./render/cerillo.obj",d=>{const p=new $().setFromObject(d).getCenter(new z);d.position.sub(p),d.scale.set(-1,1,1),r=d,t.add(r),x&&setTimeout(()=>x.update(),200)});let l=0,h=0,o=0,c=0;const m=Math.PI*3,f=Math.PI*3,u=3,b=-1;x?x.on("scroll",d=>{const v=d.scroll.y,p=d.limit.y,L=p>0?Math.min(v/p,1):0;l=L*m,h=L*f,c=-L*u,o=L*b}):window.addEventListener("scroll",()=>{const d=window.scrollY,v=document.body.scrollHeight-window.innerHeight,p=Math.min(d/v,1);l=p*m,h=p*f,c=-p*u,o=p*b});function w(){if(requestAnimationFrame(w),r){r.rotation.x+=(l-r.rotation.x)*.2,r.rotation.y+=(h-r.rotation.y)*.2,r.position.y+=(c-r.position.y)*.1,r.position.x+=(o-r.position.x)*.1;const d=Math.abs(r.position.y),v=te.clamp(1+d*.25,1,1.6);a.scale.set(v,1,1),a.rotation.z=-r.rotation.y*.4}n.render(t,e)}w(),window.addEventListener("resize",()=>{e.aspect=window.innerWidth/window.innerHeight,e.updateProjectionMatrix(),n.setSize(window.innerWidth,window.innerHeight),x&&x.update()})};function me(){ce();const x=se();de(x)}export{me as init};
