import{L as X,F as J,C as K,S as Q,G as Z,B as k,a as C,b as U,M as N,P as I,c as $,d as O,e as R,f as G,V as _,g as ee,h as te,W as se,A as ne,D as ie,i as oe,j as re,k as ae,l as le,m as ce}from"./three-yH4q0MRI.js";import{s as de}from"./loadLocomotive-DUo0yfuB.js";const he=/^[og]\s*(.+)?/,ue=/^mtllib /,me=/^usemtl /,fe=/^usemap /,T=/\s+/,Y=new _,B=new _,W=new _,q=new _,z=new _,F=new K;function pe(){const r={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(e,t){if(this.object&&this.object.fromDeclaration===!1){this.object.name=e,this.object.fromDeclaration=t!==!1;return}const i=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:t!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(s,n){const l=this._finalize(!1);l&&(l.inherited||l.groupCount<=0)&&this.materials.splice(l.index,1);const p={index:this.materials.length,name:s||"",mtllib:Array.isArray(n)&&n.length>0?n[n.length-1]:"",smooth:l!==void 0?l.smooth:this.smooth,groupStart:l!==void 0?l.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(b){const a={index:typeof b=="number"?b:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return a.clone=this.clone.bind(a),a}};return this.materials.push(p),p},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(s){const n=this.currentMaterial();if(n&&n.groupEnd===-1&&(n.groupEnd=this.geometry.vertices.length/3,n.groupCount=n.groupEnd-n.groupStart,n.inherited=!1),s&&this.materials.length>1)for(let l=this.materials.length-1;l>=0;l--)this.materials[l].groupCount<=0&&this.materials.splice(l,1);return s&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),n}},i&&i.name&&typeof i.clone=="function"){const s=i.clone(0);s.inherited=!0,this.object.materials.push(s)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(e,t){const i=parseInt(e,10);return(i>=0?i-1:i+t/3)*3},parseNormalIndex:function(e,t){const i=parseInt(e,10);return(i>=0?i-1:i+t/3)*3},parseUVIndex:function(e,t){const i=parseInt(e,10);return(i>=0?i-1:i+t/2)*2},addVertex:function(e,t,i){const s=this.vertices,n=this.object.geometry.vertices;n.push(s[e+0],s[e+1],s[e+2]),n.push(s[t+0],s[t+1],s[t+2]),n.push(s[i+0],s[i+1],s[i+2])},addVertexPoint:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,i){const s=this.normals,n=this.object.geometry.normals;n.push(s[e+0],s[e+1],s[e+2]),n.push(s[t+0],s[t+1],s[t+2]),n.push(s[i+0],s[i+1],s[i+2])},addFaceNormal:function(e,t,i){const s=this.vertices,n=this.object.geometry.normals;Y.fromArray(s,e),B.fromArray(s,t),W.fromArray(s,i),z.subVectors(W,B),q.subVectors(Y,B),z.cross(q),z.normalize(),n.push(z.x,z.y,z.z),n.push(z.x,z.y,z.z),n.push(z.x,z.y,z.z)},addColor:function(e,t,i){const s=this.colors,n=this.object.geometry.colors;s[e]!==void 0&&n.push(s[e+0],s[e+1],s[e+2]),s[t]!==void 0&&n.push(s[t+0],s[t+1],s[t+2]),s[i]!==void 0&&n.push(s[i+0],s[i+1],s[i+2])},addUV:function(e,t,i){const s=this.uvs,n=this.object.geometry.uvs;n.push(s[e+0],s[e+1]),n.push(s[t+0],s[t+1]),n.push(s[i+0],s[i+1])},addDefaultUV:function(){const e=this.object.geometry.uvs;e.push(0,0),e.push(0,0),e.push(0,0)},addUVLine:function(e){const t=this.uvs;this.object.geometry.uvs.push(t[e+0],t[e+1])},addFace:function(e,t,i,s,n,l,p,b,a){const m=this.vertices.length;let o=this.parseVertexIndex(e,m),h=this.parseVertexIndex(t,m),f=this.parseVertexIndex(i,m);if(this.addVertex(o,h,f),this.addColor(o,h,f),p!==void 0&&p!==""){const g=this.normals.length;o=this.parseNormalIndex(p,g),h=this.parseNormalIndex(b,g),f=this.parseNormalIndex(a,g),this.addNormal(o,h,f)}else this.addFaceNormal(o,h,f);if(s!==void 0&&s!==""){const g=this.uvs.length;o=this.parseUVIndex(s,g),h=this.parseUVIndex(n,g),f=this.parseUVIndex(l,g),this.addUV(o,h,f),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(e){this.object.geometry.type="Points";const t=this.vertices.length;for(let i=0,s=e.length;i<s;i++){const n=this.parseVertexIndex(e[i],t);this.addVertexPoint(n),this.addColor(n)}},addLineGeometry:function(e,t){this.object.geometry.type="Line";const i=this.vertices.length,s=this.uvs.length;for(let n=0,l=e.length;n<l;n++)this.addVertexLine(this.parseVertexIndex(e[n],i));for(let n=0,l=t.length;n<l;n++)this.addUVLine(this.parseUVIndex(t[n],s))}};return r.startObject("",!1),r}class ge extends X{constructor(e){super(e),this.materials=null}load(e,t,i,s){const n=this,l=new J(this.manager);l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(p){try{t(n.parse(p))}catch(b){s?s(b):console.error(b),n.manager.itemError(e)}},i,s)}setMaterials(e){return this.materials=e,this}parse(e){const t=new pe;e.indexOf(`\r
`)!==-1&&(e=e.replace(/\r\n/g,`
`)),e.indexOf(`\\
`)!==-1&&(e=e.replace(/\\\n/g,""));const i=e.split(`
`);let s=[];for(let p=0,b=i.length;p<b;p++){const a=i[p].trimStart();if(a.length===0)continue;const m=a.charAt(0);if(m!=="#")if(m==="v"){const o=a.split(T);switch(o[0]){case"v":t.vertices.push(parseFloat(o[1]),parseFloat(o[2]),parseFloat(o[3])),o.length>=7?(F.setRGB(parseFloat(o[4]),parseFloat(o[5]),parseFloat(o[6]),Q),t.colors.push(F.r,F.g,F.b)):t.colors.push(void 0,void 0,void 0);break;case"vn":t.normals.push(parseFloat(o[1]),parseFloat(o[2]),parseFloat(o[3]));break;case"vt":t.uvs.push(parseFloat(o[1]),parseFloat(o[2]));break}}else if(m==="f"){const h=a.slice(1).trim().split(T),f=[];for(let c=0,y=h.length;c<y;c++){const d=h[c];if(d.length>0){const u=d.split("/");f.push(u)}}const g=f[0];for(let c=1,y=f.length-1;c<y;c++){const d=f[c],u=f[c+1];t.addFace(g[0],d[0],u[0],g[1],d[1],u[1],g[2],d[2],u[2])}}else if(m==="l"){const o=a.substring(1).trim().split(" ");let h=[];const f=[];if(a.indexOf("/")===-1)h=o;else for(let g=0,c=o.length;g<c;g++){const y=o[g].split("/");y[0]!==""&&h.push(y[0]),y[1]!==""&&f.push(y[1])}t.addLineGeometry(h,f)}else if(m==="p"){const h=a.slice(1).trim().split(" ");t.addPointGeometry(h)}else if((s=he.exec(a))!==null){const o=(" "+s[0].slice(1).trim()).slice(1);t.startObject(o)}else if(me.test(a))t.object.startMaterial(a.substring(7).trim(),t.materialLibraries);else if(ue.test(a))t.materialLibraries.push(a.substring(7).trim());else if(fe.test(a))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(m==="s"){if(s=a.split(" "),s.length>1){const h=s[1].trim().toLowerCase();t.object.smooth=h!=="0"&&h!=="off"}else t.object.smooth=!0;const o=t.object.currentMaterial();o&&(o.smooth=t.object.smooth)}else{if(a==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+a+'"')}}t.finalize();const n=new Z;if(n.materialLibraries=[].concat(t.materialLibraries),!(t.objects.length===1&&t.objects[0].geometry.vertices.length===0)===!0)for(let p=0,b=t.objects.length;p<b;p++){const a=t.objects[p],m=a.geometry,o=a.materials,h=m.type==="Line",f=m.type==="Points";let g=!1;if(m.vertices.length===0)continue;const c=new k;c.setAttribute("position",new C(m.vertices,3)),m.normals.length>0&&c.setAttribute("normal",new C(m.normals,3)),m.colors.length>0&&(g=!0,c.setAttribute("color",new C(m.colors,3))),m.hasUVIndices===!0&&c.setAttribute("uv",new C(m.uvs,2));const y=[];for(let u=0,x=o.length;u<x;u++){const L=o[u],D=L.name+"_"+L.smooth+"_"+g;let v=t.materials[D];if(this.materials!==null){if(v=this.materials.create(L.name),h&&v&&!(v instanceof U)){const V=new U;N.prototype.copy.call(V,v),V.color.copy(v.color),v=V}else if(f&&v&&!(v instanceof I)){const V=new I({size:10,sizeAttenuation:!1});N.prototype.copy.call(V,v),V.color.copy(v.color),V.map=v.map,v=V}}v===void 0&&(h?v=new U:f?v=new I({size:1,sizeAttenuation:!1}):v=new $,v.name=L.name,v.flatShading=!L.smooth,v.vertexColors=g,t.materials[D]=v),y.push(v)}let d;if(y.length>1){for(let u=0,x=o.length;u<x;u++){const L=o[u];c.addGroup(L.groupStart,L.groupCount,u)}h?d=new O(c,y):f?d=new R(c,y):d=new G(c,y)}else h?d=new O(c,y[0]):f?d=new R(c,y[0]):d=new G(c,y[0]);d.name=a.name,n.add(d)}else if(t.vertices.length>0){const p=new I({size:1,sizeAttenuation:!1}),b=new k;b.setAttribute("position",new C(t.vertices,3)),t.colors.length>0&&t.colors[0]!==void 0&&(b.setAttribute("color",new C(t.colors,3)),p.vertexColors=!0);const a=new R(b,p);n.add(a)}return n}}let P=null,w=null,S=null,A=null,j=null,M=null;const ve=()=>{const r=document.getElementById("modal-video"),e=r.querySelector("video"),t=()=>{r.showModal(),e.play()},i=()=>{e.pause(),e.currentTime=0,r.close()},s=()=>{e.pause(),e.currentTime=0},n=document.querySelector(".btn-play"),l=document.querySelector("#modal-video .close");return n&&n.addEventListener("click",t),l&&l.addEventListener("click",i),r&&r.addEventListener("close",s),()=>{n&&n.removeEventListener("click",t),l&&l.removeEventListener("click",i),r&&r.removeEventListener("close",s)}},ye=r=>{M=new ee,M.background=null;const e=new te(60,window.innerWidth/window.innerHeight,.1,100);e.position.set(0,0,6),e.lookAt(0,0,0),w=new se({antialias:!0,alpha:!0}),w.setSize(window.innerWidth,window.innerHeight),w.setPixelRatio(Math.min(window.devicePixelRatio,2)),w.domElement.style.position="fixed",w.domElement.style.top="-130px",w.domElement.style.left="30px",w.domElement.style.pointerEvents="none";const t=document.querySelector("main");t&&t.insertAdjacentElement("afterbegin",w.domElement),M.add(new ne(16777215,2));const i=new ie(16777215,1.6);i.position.set(2,.3,5),M.add(i);function s(){const u=document.createElement("canvas");u.width=256,u.height=256;const x=u.getContext("2d"),L=x.createRadialGradient(256/2,256/2,256*.15,256/2,256/2,256*.5);return L.addColorStop(0,"rgba(0,0,0,0.1)"),L.addColorStop(1,"rgba(0,0,0,0)"),x.fillStyle=L,x.fillRect(0,0,256,256),new le(u)}const n=new G(new oe(1,.5),new re({map:s(),transparent:!0,depthWrite:!1}));n.rotation.x=1,n.rotation.y=-1,n.rotation.z=-1,n.position.set(.3,.4,.1),new ge().load("./render/cerillo.obj",d=>{const x=new ae().setFromObject(d).getCenter(new _);d.position.sub(x),d.scale.set(-1,1,1),j=d,M.add(j),r&&setTimeout(()=>r.update(),200)});let p=0,b=0,a=0,m=0;const o=Math.PI*3,h=Math.PI*3,f=3,g=-1;let c=null;r?(c=d=>{const u=d.scroll.y,x=d.limit.y,L=x>0?Math.min(u/x,1):0;p=L*o,b=L*h,m=-L*f,a=L*g},r.on("scroll",c)):(c=()=>{const d=window.scrollY,u=document.body.scrollHeight-window.innerHeight,x=Math.min(d/u,1);p=x*o,b=x*h,m=-x*f,a=x*g},window.addEventListener("scroll",c));function y(){if(S=requestAnimationFrame(y),j){j.rotation.x+=(p-j.rotation.x)*.2,j.rotation.y+=(b-j.rotation.y)*.2,j.position.y+=(m-j.position.y)*.1,j.position.x+=(a-j.position.x)*.1;const d=Math.abs(j.position.y),u=ce.clamp(1+d*.25,1,1.6);n.scale.set(u,1,1),n.rotation.z=-j.rotation.y*.4}w&&M&&e&&w.render(M,e)}return y(),A=()=>{e.aspect=window.innerWidth/window.innerHeight,e.updateProjectionMatrix(),w&&w.setSize(window.innerWidth,window.innerHeight),r&&r.update()},window.addEventListener("resize",A),{scrollHandler:c,locomotiveScroll:r}};let H=null,E=null;function xe(){H=ve(),P=de(),E=ye(P)}function Le(){S&&(cancelAnimationFrame(S),S=null),A&&(window.removeEventListener("resize",A),A=null),E&&(E.locomotiveScroll&&E.scrollHandler?E.locomotiveScroll.off("scroll",E.scrollHandler):E.scrollHandler&&window.removeEventListener("scroll",E.scrollHandler),E=null),P&&(P.destroy(),P=null),j&&(j.traverse(r=>{r.geometry&&r.geometry.dispose(),r.material&&(Array.isArray(r.material)?r.material.forEach(e=>e.dispose()):r.material.dispose())}),j=null),M&&(M.traverse(r=>{r.geometry&&r.geometry.dispose(),r.material&&(Array.isArray(r.material)?r.material.forEach(e=>{e.map&&e.map.dispose(),e.dispose()}):(r.material.map&&r.material.map.dispose(),r.material.dispose()))}),M.clear(),M=null),w&&(w.dispose(),w.forceContextLoss(),w.domElement&&w.domElement.parentNode&&w.domElement.parentNode.removeChild(w.domElement),w=null),H&&(H(),H=null)}export{Le as destroy,xe as init};
