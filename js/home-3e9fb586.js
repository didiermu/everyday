import{V as z,C as H,L as O,F as k,S as N,G as T,B as F,a as V,b as P,M as E,P as M,c as W,d as U,e as C,f as S,g as q,h as Y,W as X,A as J,D as K,i as Q,j as Z,k as $,l as ee,m as te}from"./three-7e024fe7.js";const se=/^[og]\s*(.+)?/,ne=/^mtllib /,ie=/^usemtl /,oe=/^usemap /,R=/\s+/,B=new z,I=new z,G=new z,D=new z,j=new z,_=new H;function re(){const v={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(t,e){if(this.object&&this.object.fromDeclaration===!1){this.object.name=t,this.object.fromDeclaration=e!==!1;return}const i=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:t||"",fromDeclaration:e!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(s,n){const o=this._finalize(!1);o&&(o.inherited||o.groupCount<=0)&&this.materials.splice(o.index,1);const g={index:this.materials.length,name:s||"",mtllib:Array.isArray(n)&&n.length>0?n[n.length-1]:"",smooth:o!==void 0?o.smooth:this.smooth,groupStart:o!==void 0?o.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(w){const a={index:typeof w=="number"?w:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return a.clone=this.clone.bind(a),a}};return this.materials.push(g),g},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(s){const n=this.currentMaterial();if(n&&n.groupEnd===-1&&(n.groupEnd=this.geometry.vertices.length/3,n.groupCount=n.groupEnd-n.groupStart,n.inherited=!1),s&&this.materials.length>1)for(let o=this.materials.length-1;o>=0;o--)this.materials[o].groupCount<=0&&this.materials.splice(o,1);return s&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),n}},i&&i.name&&typeof i.clone=="function"){const s=i.clone(0);s.inherited=!0,this.object.materials.push(s)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(t,e){const i=parseInt(t,10);return(i>=0?i-1:i+e/3)*3},parseNormalIndex:function(t,e){const i=parseInt(t,10);return(i>=0?i-1:i+e/3)*3},parseUVIndex:function(t,e){const i=parseInt(t,10);return(i>=0?i-1:i+e/2)*2},addVertex:function(t,e,i){const s=this.vertices,n=this.object.geometry.vertices;n.push(s[t+0],s[t+1],s[t+2]),n.push(s[e+0],s[e+1],s[e+2]),n.push(s[i+0],s[i+1],s[i+2])},addVertexPoint:function(t){const e=this.vertices;this.object.geometry.vertices.push(e[t+0],e[t+1],e[t+2])},addVertexLine:function(t){const e=this.vertices;this.object.geometry.vertices.push(e[t+0],e[t+1],e[t+2])},addNormal:function(t,e,i){const s=this.normals,n=this.object.geometry.normals;n.push(s[t+0],s[t+1],s[t+2]),n.push(s[e+0],s[e+1],s[e+2]),n.push(s[i+0],s[i+1],s[i+2])},addFaceNormal:function(t,e,i){const s=this.vertices,n=this.object.geometry.normals;B.fromArray(s,t),I.fromArray(s,e),G.fromArray(s,i),j.subVectors(G,I),D.subVectors(B,I),j.cross(D),j.normalize(),n.push(j.x,j.y,j.z),n.push(j.x,j.y,j.z),n.push(j.x,j.y,j.z)},addColor:function(t,e,i){const s=this.colors,n=this.object.geometry.colors;s[t]!==void 0&&n.push(s[t+0],s[t+1],s[t+2]),s[e]!==void 0&&n.push(s[e+0],s[e+1],s[e+2]),s[i]!==void 0&&n.push(s[i+0],s[i+1],s[i+2])},addUV:function(t,e,i){const s=this.uvs,n=this.object.geometry.uvs;n.push(s[t+0],s[t+1]),n.push(s[e+0],s[e+1]),n.push(s[i+0],s[i+1])},addDefaultUV:function(){const t=this.object.geometry.uvs;t.push(0,0),t.push(0,0),t.push(0,0)},addUVLine:function(t){const e=this.uvs;this.object.geometry.uvs.push(e[t+0],e[t+1])},addFace:function(t,e,i,s,n,o,g,w,a){const d=this.vertices.length;let r=this.parseVertexIndex(t,d),l=this.parseVertexIndex(e,d),f=this.parseVertexIndex(i,d);if(this.addVertex(r,l,f),this.addColor(r,l,f),g!==void 0&&g!==""){const m=this.normals.length;r=this.parseNormalIndex(g,m),l=this.parseNormalIndex(w,m),f=this.parseNormalIndex(a,m),this.addNormal(r,l,f)}else this.addFaceNormal(r,l,f);if(s!==void 0&&s!==""){const m=this.uvs.length;r=this.parseUVIndex(s,m),l=this.parseUVIndex(n,m),f=this.parseUVIndex(o,m),this.addUV(r,l,f),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(t){this.object.geometry.type="Points";const e=this.vertices.length;for(let i=0,s=t.length;i<s;i++){const n=this.parseVertexIndex(t[i],e);this.addVertexPoint(n),this.addColor(n)}},addLineGeometry:function(t,e){this.object.geometry.type="Line";const i=this.vertices.length,s=this.uvs.length;for(let n=0,o=t.length;n<o;n++)this.addVertexLine(this.parseVertexIndex(t[n],i));for(let n=0,o=e.length;n<o;n++)this.addUVLine(this.parseUVIndex(e[n],s))}};return v.startObject("",!1),v}class ae extends O{constructor(t){super(t),this.materials=null}load(t,e,i,s){const n=this,o=new k(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(t,function(g){try{e(n.parse(g))}catch(w){s?s(w):console.error(w),n.manager.itemError(t)}},i,s)}setMaterials(t){return this.materials=t,this}parse(t){const e=new re;t.indexOf(`\r
`)!==-1&&(t=t.replace(/\r\n/g,`
`)),t.indexOf(`\\
`)!==-1&&(t=t.replace(/\\\n/g,""));const i=t.split(`
`);let s=[];for(let g=0,w=i.length;g<w;g++){const a=i[g].trimStart();if(a.length===0)continue;const d=a.charAt(0);if(d!=="#")if(d==="v"){const r=a.split(R);switch(r[0]){case"v":e.vertices.push(parseFloat(r[1]),parseFloat(r[2]),parseFloat(r[3])),r.length>=7?(_.setRGB(parseFloat(r[4]),parseFloat(r[5]),parseFloat(r[6]),N),e.colors.push(_.r,_.g,_.b)):e.colors.push(void 0,void 0,void 0);break;case"vn":e.normals.push(parseFloat(r[1]),parseFloat(r[2]),parseFloat(r[3]));break;case"vt":e.uvs.push(parseFloat(r[1]),parseFloat(r[2]));break}}else if(d==="f"){const l=a.slice(1).trim().split(R),f=[];for(let h=0,b=l.length;h<b;h++){const c=l[h];if(c.length>0){const u=c.split("/");f.push(u)}}const m=f[0];for(let h=1,b=f.length-1;h<b;h++){const c=f[h],u=f[h+1];e.addFace(m[0],c[0],u[0],m[1],c[1],u[1],m[2],c[2],u[2])}}else if(d==="l"){const r=a.substring(1).trim().split(" ");let l=[];const f=[];if(a.indexOf("/")===-1)l=r;else for(let m=0,h=r.length;m<h;m++){const b=r[m].split("/");b[0]!==""&&l.push(b[0]),b[1]!==""&&f.push(b[1])}e.addLineGeometry(l,f)}else if(d==="p"){const l=a.slice(1).trim().split(" ");e.addPointGeometry(l)}else if((s=se.exec(a))!==null){const r=(" "+s[0].slice(1).trim()).slice(1);e.startObject(r)}else if(ie.test(a))e.object.startMaterial(a.substring(7).trim(),e.materialLibraries);else if(ne.test(a))e.materialLibraries.push(a.substring(7).trim());else if(oe.test(a))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(d==="s"){if(s=a.split(" "),s.length>1){const l=s[1].trim().toLowerCase();e.object.smooth=l!=="0"&&l!=="off"}else e.object.smooth=!0;const r=e.object.currentMaterial();r&&(r.smooth=e.object.smooth)}else{if(a==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+a+'"')}}e.finalize();const n=new T;if(n.materialLibraries=[].concat(e.materialLibraries),!(e.objects.length===1&&e.objects[0].geometry.vertices.length===0)===!0)for(let g=0,w=e.objects.length;g<w;g++){const a=e.objects[g],d=a.geometry,r=a.materials,l=d.type==="Line",f=d.type==="Points";let m=!1;if(d.vertices.length===0)continue;const h=new F;h.setAttribute("position",new V(d.vertices,3)),d.normals.length>0&&h.setAttribute("normal",new V(d.normals,3)),d.colors.length>0&&(m=!0,h.setAttribute("color",new V(d.colors,3))),d.hasUVIndices===!0&&h.setAttribute("uv",new V(d.uvs,2));const b=[];for(let u=0,x=r.length;u<x;u++){const y=r[u],A=y.name+"_"+y.smooth+"_"+m;let p=e.materials[A];if(this.materials!==null){if(p=this.materials.create(y.name),l&&p&&!(p instanceof P)){const L=new P;E.prototype.copy.call(L,p),L.color.copy(p.color),p=L}else if(f&&p&&!(p instanceof M)){const L=new M({size:10,sizeAttenuation:!1});E.prototype.copy.call(L,p),L.color.copy(p.color),L.map=p.map,p=L}}p===void 0&&(l?p=new P:f?p=new M({size:1,sizeAttenuation:!1}):p=new W,p.name=y.name,p.flatShading=!y.smooth,p.vertexColors=m,e.materials[A]=p),b.push(p)}let c;if(b.length>1){for(let u=0,x=r.length;u<x;u++){const y=r[u];h.addGroup(y.groupStart,y.groupCount,u)}l?c=new U(h,b):f?c=new C(h,b):c=new S(h,b)}else l?c=new U(h,b[0]):f?c=new C(h,b[0]):c=new S(h,b[0]);c.name=a.name,n.add(c)}else if(e.vertices.length>0){const g=new M({size:1,sizeAttenuation:!1}),w=new F;w.setAttribute("position",new V(e.vertices,3)),e.colors.length>0&&e.colors[0]!==void 0&&(w.setAttribute("color",new V(e.colors,3)),g.vertexColors=!0);const a=new C(w,g);n.add(a)}return n}}const le=()=>{const v=document.getElementById("modal-video"),t=v.querySelector("video");document.querySelector(".btn-play").addEventListener("click",()=>{v.showModal(),t.play()}),document.querySelector("#modal-video .close").addEventListener("click",()=>{t.pause(),t.currentTime=0,v.close()}),v.addEventListener("close",()=>{t.pause(),t.currentTime=0})},ce=()=>{const v=new q;v.background=null;const t=new Y(50,window.innerWidth/window.innerHeight,.1,100);t.position.set(0,0,6),t.lookAt(0,0,0);const e=new X({antialias:!0,alpha:!0});e.setSize(window.innerWidth,window.innerHeight),e.setPixelRatio(Math.min(window.devicePixelRatio,2)),document.querySelector("main").appendChild(e.domElement),v.add(new J(16777215,.9));const i=new K(16777215,1.6);i.position.set(2,3,5),v.add(i);function s(){const u=document.createElement("canvas");u.width=256,u.height=256;const x=u.getContext("2d"),y=x.createRadialGradient(256/2,256/2,256*.15,256/2,256/2,256*.5);return y.addColorStop(0,"rgba(0,0,0,0.1)"),y.addColorStop(1,"rgba(0,0,0,0)"),x.fillStyle=y,x.fillRect(0,0,256,256),new ee(u)}const n=new S(new Q(1,.5),new Z({map:s(),transparent:!0,depthWrite:!1}));n.rotation.x=1,n.rotation.y=-1,n.rotation.z=-1,n.position.set(.3,.4,.1);let o;new ae().load("./render/cerillo.obj",c=>{const x=new $().setFromObject(c).getCenter(new z);c.position.sub(x),c.scale.set(-1,1,1),o=c,o.add(n),v.add(o)});let w=0,a=0,d=0,r=0;const l=Math.PI*3,f=Math.PI*3,m=2.5,h=-1;window.addEventListener("scroll",()=>{const c=window.scrollY,u=document.body.scrollHeight-window.innerHeight,x=Math.min(c/u,1);w=x*l,a=x*f,r=-x*m,d=x*h});function b(){if(requestAnimationFrame(b),o){o.rotation.x+=(w-o.rotation.x)*.2,o.rotation.y+=(a-o.rotation.y)*.2,o.position.y+=(r-o.position.y)*.1,o.position.x+=(d-o.position.x)*.1;const c=Math.abs(o.position.y),u=te.clamp(1+c*.25,1,1.6);n.scale.set(u,1,1),n.rotation.z=-o.rotation.y*.4}e.render(v,t)}b(),window.addEventListener("resize",()=>{t.aspect=window.innerWidth/window.innerHeight,t.updateProjectionMatrix(),e.setSize(window.innerWidth,window.innerHeight)})};function he(){le(),ce()}export{he as init};
